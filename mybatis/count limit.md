### SQL 中 `count(1)` 和 `limit 1` 的行为

1. **`count(1)`**：
    - `count(1)` 是一个聚合函数，它会计算符合查询条件的所有记录的数量。
    - 通常情况下，`count(1)` 会遍历整个结果集来计算符合条件的记录数，因此在没有 `limit` 限制的情况下，数据库引擎需要查看所有符合条件的记录才能返回结果。

2. **`limit 1`**：
    - `limit 1` 表示查询结果限制为只返回一条记录。
    - 当与 `count(1)` 一起使用时，`limit 1` 实际上并不改变 `count(1)` 的结果，因为 `count(1)` 本身就只返回一条记录。

### 实际查询行为

在使用 `count(1)` 计算记录数时：

- 数据库引擎通常会遍历所有符合条件的记录以计算总数。
- 这意味着即使加上 `limit 1`，在大多数数据库实现中，`count(1)` 仍会遍历所有符合条件的记录，然后返回结果。

### `limit 1` 的优化作用

虽然在通常情况下，`count(1) limit 1` 并不会减少遍历的记录数，但有一些数据库实现或查询优化器可能会对这种查询进行优化，以提高性能。

### 优化的实际作用（取决于数据库实现）

- 一些数据库优化器可能会识别到 `count(1) limit 1` 的模式，并优化查询，使其在找到第一条符合条件的记录后立即返回，从而避免遍历整个数据集。
- 这种优化行为取决于具体的数据库实现和查询优化器的智能程度。

### 示例查询

假设我们有如下 `sys_dept` 表数据：

| dept_id | parent_id | del_flag | dept_name     |
|---------|-----------|----------|---------------|
| 1       | 0         | 0        | Headquarters  |
| 2       | 1         | 0        | HR Department |
| 3       | 1         | 1        | IT Department |
| 4       | 2         | 0        | Recruitment   |

当您执行如下查询：

```sql
select count(1)
from sys_dept
where del_flag = '0'
  and parent_id = 1 limit 1;
```

查询解释：

- `count(1)` 计算满足条件的记录数。
- `where del_flag = '0' and parent_id = 1` 过滤条件，查找未删除且父部门ID为1的记录。
- `limit 1` 希望限制结果集为一条记录。

### 实际行为

- 在没有 `limit 1` 的情况下，数据库会遍历所有符合条件的记录来计算总数。
- 在一些数据库中，`count(1) limit 1` 可能会在找到第一条符合条件的记录后立即返回，避免遍历所有记录。

### 总结

- 通常情况下，`count(1)` 会遍历所有符合条件的记录以计算总数，`limit 1` 并不会改变这个行为。
- 但在一些数据库实现中，`limit 1` 可能会启用查询优化器的优化行为，使其在找到第一条符合条件的记录后立即返回，以提高性能。

如果您希望确保只检查是否存在至少一条符合条件的记录，可以考虑使用如下查询：

```sql
select 1
from sys_dept
where del_flag = '0'
  and parent_id = #{deptId} limit 1;
```

这种查询将仅返回符合条件的第一条记录，并可以显著提高性能。